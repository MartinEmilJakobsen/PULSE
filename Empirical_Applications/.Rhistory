LWKLYWGE=V9,
MARRIED=V10,
MIDATL=V11,
MT=V12,
NEWENG=V13,
CENSUS=V16,
QOB=V18,
RACE=V19,
SMSA=V20,
SOATL=V21,
WNOCENT=V24,
WSOCENT=V25,
YOB=V27) %>%
select(-V8) %>%
mutate(COHORT = case_when( 20 <= YOB & YOB <=29 ~ "20.29",
30 <= YOB & YOB <=39 ~ "30.39",
40 <= YOB & YOB <=49 ~ "40.49",
30 <= YOB & YOB <=39 ~ "30.39",
TRUE ~ "NA"),
AGEQ = ifelse(CENSUS==80,AGEQ-1900,AGEQ),
AGEQSQ = AGEQ^2,
YOBTEMP = YOB-floor(YOB/10)*10)  %>%  #CHECK IF FAILURE
mutate(YR0 = ifelse(YOBTEMP==0,1,0),
YR1 = ifelse(YOBTEMP==1,1,0),
YR2 = ifelse(YOBTEMP==2,1,0),
YR3 = ifelse(YOBTEMP==3,1,0),
YR4 = ifelse(YOBTEMP==4,1,0),
YR5 = ifelse(YOBTEMP==5,1,0),
YR6 = ifelse(YOBTEMP==6,1,0),
YR7 = ifelse(YOBTEMP==7,1,0),
YR8 = ifelse(YOBTEMP==8,1,0),
YR9 = ifelse(YOBTEMP==9,1,0),
QTR1 = ifelse(QOB == 1, 1, 0),
QTR2 = ifelse(QOB == 2, 1, 0),
QTR3 = ifelse(QOB == 3, 1, 0),
QTR4 = ifelse(QOB == 4, 1, 0),
QTRxYR10= QTR1*YR0,
QTRxYR11= QTR1*YR1,
QTRxYR12= QTR1*YR2,
QTRxYR13= QTR1*YR3,
QTRxYR14= QTR1*YR4,
QTRxYR15= QTR1*YR5,
QTRxYR16= QTR1*YR6,
QTRxYR17= QTR1*YR7,
QTRxYR18= QTR1*YR8,
QTRxYR19= QTR1*YR9,
QTRxYR20= QTR2*YR0,
QTRxYR21= QTR2*YR1,
QTRxYR22= QTR2*YR2,
QTRxYR23= QTR2*YR3,
QTRxYR24= QTR2*YR4,
QTRxYR25= QTR2*YR5,
QTRxYR26= QTR2*YR6,
QTRxYR27= QTR2*YR7,
QTRxYR28= QTR2*YR8,
QTRxYR29= QTR2*YR9,
QTRxYR30= QTR3*YR0,
QTRxYR31= QTR3*YR1,
QTRxYR32= QTR3*YR2,
QTRxYR33= QTR3*YR3,
QTRxYR34= QTR3*YR4,
QTRxYR35= QTR3*YR5,
QTRxYR36= QTR3*YR6,
QTRxYR37= QTR3*YR7,
QTRxYR38= QTR3*YR8,
QTRxYR39= QTR3*YR9)
#################################################################
#################################################################
#################################################################
######## TABLE IV: MEN BORN 1930-1939 - 1980 CENSUS DATA ########
#################################################################
#################################################################
#################################################################
Selected_Data <- QOB_Data  %>% filter(COHORT == "30.39") %>%
select(-c(V3,V7,V14,V15,V17,V22,V23))
n <- nrow(Selected_Data)
#Target
Y <- Selected_Data %>% select(LWKLYWGE) %>%  as.matrix
#Included Exogenous:
A_1 <- Selected_Data %>% select(starts_with("YR")) %>% as.matrix
#All Exogenous
A <- Selected_Data %>% select(starts_with("YR"),starts_with("QTRxYR")) %>% as.matrix
#Included Endogenous
X <- Selected_Data %>% select(EDUC) %>%  as.matrix
#Included (all)
Z <- cbind(X,A_1)
#OLS
K_class(0,A,Z,Y,n)
#IV
K_class(1,A,Z,Y,n)
#PULSE
PULSE(A,A_1,X,Y,p=0.05,N=10000,n)
n <- nrow(Selected_Data)
#Target
Y <- Selected_Data %>% select(LWKLYWGE) %>%  as.matrix
#Included Exogenous:
A_1 <- Selected_Data %>% select(starts_with("YR"),AGEQ,AGEQSQ) %>% as.matrix
#All Exogenous
A <- Selected_Data %>% select(starts_with("YR"),AGEQ,AGEQSQ,starts_with("QTRxYR"),-QTRxYR38,-QTRxYR39) %>% as.matrix
#Included Endogenous
X <- Selected_Data %>% select(EDUC) %>%  as.matrix
#Included (all)
Z <- cbind(X,A_1)
#OLS
K_class(0,A,Z,Y,n)
#IV
K_class(1,A,Z,Y,n)
#PULSE
PULSE(A,A_1,X,Y,p=0.05,N=1000,n)
n <- nrow(Selected_Data)
#Target
Y <- Selected_Data %>% select(LWKLYWGE) %>%  as.matrix
#Included Exogenous:
A_1 <- Selected_Data %>% select(starts_with("YR"),RACE,MARRIED,SMSA,NEWENG,MIDATL,ENOCENT,WNOCENT,SOATL,ESOCENT,WSOCENT,MT) %>% as.matrix
#All Exogenous
A <- Selected_Data %>% select(starts_with("YR"),RACE,MARRIED,SMSA,NEWENG,MIDATL,ENOCENT,WNOCENT,SOATL,ESOCENT,WSOCENT,MT,starts_with("QTRxYR")) %>% as.matrix
#Included Endogenous
X <- Selected_Data %>% select(EDUC) %>%  as.matrix
#Included (all)
Z <- cbind(X,A_1)
#OLS
K_class(0,A,Z,Y,n)
#IV
K_class(1,A,Z,Y,n)
#PULSE
PULSE(A,A_1,X,Y,p=0.05,N=1000,n)
n <- nrow(Selected_Data)
#Target
Y <- Selected_Data %>% select(LWKLYWGE) %>%  as.matrix
#Included Exogenous:
A_1 <- Selected_Data %>% select(starts_with("YR"),AGEQ,AGEQSQ,RACE, MARRIED, SMSA, NEWENG, MIDATL, ENOCENT, WNOCENT, SOATL, ESOCENT, WSOCENT, MT) %>% as.matrix
#All Exogenous
A <- Selected_Data %>% select(starts_with("YR"),AGEQ,AGEQSQ,RACE, MARRIED, SMSA, NEWENG, MIDATL, ENOCENT, WNOCENT, SOATL, ESOCENT, WSOCENT, MT,starts_with("QTRxYR"),-QTRxYR38,-QTRxYR39) %>% as.matrix
#Included Endogenous
X <- Selected_Data %>% select(EDUC) %>%  as.matrix
#Included (all)
Z <- cbind(X,A_1)
#OLS
K_class(0,A,Z,Y,n)
#IV
K_class(1,A,Z,Y,n)
#PULSE
PULSE(A,A_1,X,Y,p=0.05,N=10000,n)
getwd()
source("../Estimators_Slow.R")
COLONIAL_Data <- read.delim(file="Data/COLONIAL_T4.csv",sep=",",header=TRUE)  %>% mutate(Intercept = 1)
###################################
###################################
###################################
######## TABLE IV: COLONIAL #######
###################################
###################################
###################################
Selected_Data <- COLONIAL_Data  %>% filter(baseco == 1)
#LM and IVREG check
lm(logpgp95~avexpr,data=Selected_Data)
n <- nrow(Selected_Data)
#Target
Y <- Selected_Data %>% select(logpgp95) %>%  as.matrix
#Included Exogenous:
A_1 <- Selected_Data %>% select(Intercept) %>%  as.matrix
#All Exogenous
A <- Selected_Data %>% select(logem4,Intercept) %>% as.matrix
#Included Endogenous
X <- Selected_Data %>% select(avexpr) %>%  as.matrix
#Included (all)
Z <- cbind(X,A_1)
#OLS
K_class(0,A,Z,Y,n)
#IV
K_class(1,A,Z,Y,n)
#PULSE
PULSE(A,A_1,X,Y,p=0.05,N=10000,n)
K_class(FULLER_k(4,A,A_1,X,Y,n,2),A,Z,Y,n)
n <- nrow(Selected_Data)
#Target
Y <- Selected_Data %>% select(logpgp95) %>%  as.matrix
#Included Exogenous:
A_1 <- Selected_Data %>% select(lat_abst,Intercept) %>%  as.matrix
#All Exogenous
A <- Selected_Data %>% select(lat_abst,logem4,Intercept) %>% as.matrix
#Included Endogenous
X <- Selected_Data %>% select(avexpr) %>%  as.matrix
#Included (all)
Z <- cbind(X,A_1)
#OLS
K_class(0,A,Z,Y,n)
#IV
K_class(1,A,Z,Y,n)
#PULSE
PULSE(A,A_1,X,Y,p=0.05,N=10000,n)
Selected_Data_woNeoEuropes <- Selected_Data %>%  filter(rich4!= 1)
n <- nrow(Selected_Data_woNeoEuropes)
#Target
Y <- Selected_Data_woNeoEuropes %>% select(logpgp95) %>%  as.matrix
#Included Exogenous:
A_1 <- Selected_Data_woNeoEuropes %>% select(Intercept) %>%  as.matrix
#All Exogenous
A <- Selected_Data_woNeoEuropes %>% select(logem4,Intercept) %>% as.matrix
#Included Endogenous
X <- Selected_Data_woNeoEuropes %>% select(avexpr) %>%  as.matrix
#Included (all)
Z <- cbind(X,A_1)
#OLS
K_class(0,A,Z,Y,n)
#IV
K_class(1,A,Z,Y,n)
#PULSE
PULSE(A,A_1,X,Y,p=0.05,N=10000,n)
n <- nrow(Selected_Data)
#Target
Y <- Selected_Data %>% select(lwage76)  %>% as.matrix
#Included Exogenous:
A_1 <- Selected_Data %>% select(black,smsa76r,reg76r,smsa66r,reg662,reg663,reg664,reg665,reg666,reg667,reg668,reg669,Intercept,daded,momed,nodaded,nomomed ,f1,f2,f3,f4,f5,f6,f7,f8,momdad14,sinmom14) %>%  as.matrix
#All Exogenous
A <- Selected_Data %>% select(nearc4,age,agesq,black,smsa76r,reg76r,smsa66r,reg662,reg663,reg664,reg665,reg666,reg667,reg668,reg669,Intercept,daded,momed,nodaded,nomomed ,f1,f2,f3,f4,f5,f6,f7,f8,momdad14,sinmom14) %>% as.matrix
#Included Endogenous
X <- Selected_Data %>% select(ed76,exp,expsq) %>%  as.matrix
#Included (all)
Z <- cbind(X,A_1)
#OLS
K_class(0,A,Z,Y,n)
#IV
K_class(1,A,Z,Y,n)
getwd()
source("../Estimators_Slow.R")
'Proximity_Data' <- read.delim(file="Data/nls.dat",sep="",header=FALSE)  %>% rename(
id                =  V1,
nearc2            =  V2,
nearc4          =  V3,
nearc4a         =  V4,
nearc4b         =  V5,
ed76            =  V6,
ed66              =  V7,
age76             =  V8,
daded           =  V9,
nodaded           =  V10,
momed           =  V11,
nomomed           =  V12,
weight          =  V13,
momdad14        =  V14,
sinmom14        =  V15,
step14          =  V16,
reg661          =  V17,
reg662          =  V18,
reg663          =  V19,
reg664          =  V20,
reg665            =  V21,
reg666            =  V22,
reg667            =  V23,
reg668            =  V24,
reg669            =  V25,
south66         =  V26,
work76          =  V27,
work78          =  V28,
lwage76         =  V29,
lwage78         =  V30,
famed           =  V31,
black             =  V32,
smsa76r         =  V33,
smsa78r         =  V34,
reg76r          =  V35,
reg78r            =  V36,
reg80r            =  V37,
smsa66r         =  V38,
wage76          =  V39,
wage78            =  V40,
wage80            =  V41,
noint78           =  V42,
noint80         =  V43,
enroll76          =  V44,
enroll78        =  V45,
enroll80          =  V46,
kww               =  V47,
iq                =  V48,
marsta76          =  V49,
marsta78        =  V50,
marsta80          =  V51,
libcrd14          =  V52
) %>% as_tibble() %>%
mutate(Intercept = 1)%>%
mutate(lwage76= ifelse(lwage76==".","0",lwage76) )%>%
mutate(lwage76 = as.numeric(lwage76)) %>%
mutate(iq = ifelse(iq==".","0",iq)) %>%
mutate(iq = as.numeric(iq)) %>%
mutate(exp = age76-ed76-6) %>%
mutate(expsq = exp^2) %>%
mutate(age=age76,agesq=age76^2) %>%
mutate(f1 = ifelse(famed==1,1,0),
f2 = ifelse(famed==2,1,0),
f3 = ifelse(famed==3,1,0),
f4 = ifelse(famed==4,1,0),
f5 = ifelse(famed==5,1,0),
f6 = ifelse(famed==6,1,0),
f7 = ifelse(famed==7,1,0),
f8 = ifelse(famed==8,1,0))
#################################################################
#################################################################
#################################################################
######## TABLE IV: MEN BORN 1930-1939 - 1980 CENSUS DATA ########
#################################################################
#################################################################
#################################################################
Selected_Data <- Proximity_Data
n <- nrow(Selected_Data)
#Target
Y <- Selected_Data %>% select(lwage76)  %>% as.matrix
#Included Exogenous:
A_1 <- Selected_Data %>% select(black,exp,expsq,smsa76r,reg76r,smsa66r,reg662,reg663,reg664,reg665,reg666,reg667,reg668,reg669,Intercept) %>%  as.matrix
#All Exogenous
A <- Selected_Data %>% select(nearc4,exp,expsq,black,smsa76r,reg76r,smsa66r,reg662,reg663,reg664,reg665,reg666,reg667,reg668,reg669,Intercept) %>% as.matrix
#Included Endogenous
X <- Selected_Data %>% select(ed76) %>%  as.matrix
#Included (all)
Z <- cbind(X,A_1)
#OLS
K_class(0,A,Z,Y,n)
#IV
K_class(1,A,Z,Y,n)
n <- nrow(Selected_Data)
#Target
Y <- Selected_Data %>% select(lwage76)  %>% as.matrix
#Included Exogenous:
A_1 <- Selected_Data %>% select(black,exp,expsq,smsa76r,reg76r,smsa66r,reg662,reg663,reg664,reg665,reg666,reg667,reg668,reg669) %>%  as.matrix
#All Exogenous
A <- Selected_Data %>% select(nearc4,exp,expsq,black,smsa76r,reg76r,smsa66r,reg662,reg663,reg664,reg665,reg666,reg667,reg668,reg669) %>% as.matrix
#Included Endogenous
X <- Selected_Data %>% select(ed76) %>%  as.matrix
#Included (all)
Z <- cbind(X,A_1)
#OLS
K_class(0,A,Z,Y,n)
#IV
K_class(1,A,Z,Y,n)
n <- nrow(Selected_Data)
#Target
Y <- Selected_Data %>% select(lwage76)  %>% as.matrix
#Included Exogenous:
A_1 <- Selected_Data %>% select(black,exp,expsq,smsa76r,reg76r,smsa66r,reg662,reg663,reg664,reg665,reg666,reg667,reg668,reg669,Intercept) %>%  as.matrix
#All Exogenous
A <- Selected_Data %>% select(nearc4,exp,expsq,black,smsa76r,reg76r,smsa66r,reg662,reg663,reg664,reg665,reg666,reg667,reg668,reg669,Intercept) %>% as.matrix
#Included Endogenous
X <- Selected_Data %>% select(ed76) %>%  as.matrix
#Included (all)
Z <- cbind(X,A_1)
#OLS
K_class(0,A,Z,Y,n)
#IV
K_class(1,A,Z,Y,n)
#PULSE
PULSE(A,A_1,X,Y,p=0.05,N=10000,n)
Y
X
summary(X)
X[which(X<=16)]
which(X<=16)
A
############################################################################
#COLUMN 4 :  logpgp95 ~ avexpr + lat_abst (INSTRUMENTS = logem4 + lat_abst) w/o Neo-Europes
############################################################################
Selected_Data_woNeoEuropes <- Selected_Data %>%  filter(rich4!= 1)
Selected_Data
COLONIAL_Data <- read.delim(file="Data/COLONIAL_T4.csv",sep=",",header=TRUE)  %>% mutate(Intercept = 1)
COLONIAL_Data
COLONIAL_Data %>%  as_tibble()
n <- nrow(Selected_Data)
#Target
Y <- Selected_Data %>% select(logpgp95) %>%  as.matrix
#Included Exogenous:
A_1 <- Selected_Data %>% select(Intercept) %>%  as.matrix
#All Exogenous
A <- Selected_Data %>% select(logem4,Intercept) %>% as.matrix
#Included Endogenous
X <- Selected_Data %>% select(avexpr) %>%  as.matrix
#Included (all)
Z <- cbind(X,A_1)
#OLS
K_class(0,A,Z,Y,n)
#IV
K_class(1,A,Z,Y,n)
#PULSE
PULSE(A,A_1,X,Y,p=0.05,N=10000,n)
Selected_Data <- COLONIAL_Data  %>% filter(baseco == 1)
n <- nrow(Selected_Data)
#Target
Y <- Selected_Data %>% select(logpgp95) %>%  as.matrix
#Included Exogenous:
A_1 <- Selected_Data %>% select(Intercept) %>%  as.matrix
#All Exogenous
A <- Selected_Data %>% select(logem4,Intercept) %>% as.matrix
#Included Endogenous
X <- Selected_Data %>% select(avexpr) %>%  as.matrix
#Included (all)
Z <- cbind(X,A_1)
#OLS
K_class(0,A,Z,Y,n)
#IV
K_class(1,A,Z,Y,n)
#PULSE
PULSE(A,A_1,X,Y,p=0.05,N=10000,n)
############################################################################
#COLUMN 7 :  logpgp95 ~ avexpr + africa + asia + other_cont (INSTRUMENTS = africa + asia + other_cont+ logem4 ) w/continentIndicator
############################################################################
Selected_Data_wContinent <- Selected_Data %>%  mutate(other_cont = ifelse(shortnam %in% c("AUS","MLT","NZL"),1,0))
############################################################################
#COLUMN 8 :  logpgp95 ~ avexpr + lat_abst + africa + asia + other_cont (INSTRUMENTS = lat_abst + africa + asia + other_cont ) w/continentIndicator
############################################################################
Selected_Data_wContinent <- Selected_Data %>%  mutate(other_cont = ifelse(shortnam %in% c("AUS","MLT","NZL"),1,0))
A
#All Exogenous
A <- Selected_Data_wContinent %>% select(Intercept,africa,asia,other_cont,logem4,lat_abst) %>% as.matrix
A
K_class(0,A,Z,Y,n)
#IV
K_class(1,A,Z,Y,n)
#PULSE
PULSE(A,A_1,X,Y,p=0.05,N=10000,n)
'Proximity_Data' <- read.delim(file="Data/nls.dat",sep="",header=FALSE)  %>% rename(
id                =  V1,
nearc2            =  V2,
nearc4          =  V3,
nearc4a         =  V4,
nearc4b         =  V5,
ed76            =  V6,
ed66              =  V7,
age76             =  V8,
daded           =  V9,
nodaded           =  V10,
momed           =  V11,
nomomed           =  V12,
weight          =  V13,
momdad14        =  V14,
sinmom14        =  V15,
step14          =  V16,
reg661          =  V17,
reg662          =  V18,
reg663          =  V19,
reg664          =  V20,
reg665            =  V21,
reg666            =  V22,
reg667            =  V23,
reg668            =  V24,
reg669            =  V25,
south66         =  V26,
work76          =  V27,
work78          =  V28,
lwage76         =  V29,
lwage78         =  V30,
famed           =  V31,
black             =  V32,
smsa76r         =  V33,
smsa78r         =  V34,
reg76r          =  V35,
reg78r            =  V36,
reg80r            =  V37,
smsa66r         =  V38,
wage76          =  V39,
wage78            =  V40,
wage80            =  V41,
noint78           =  V42,
noint80         =  V43,
enroll76          =  V44,
enroll78        =  V45,
enroll80          =  V46,
kww               =  V47,
iq                =  V48,
marsta76          =  V49,
marsta78        =  V50,
marsta80          =  V51,
libcrd14          =  V52
) %>% as_tibble() %>%
mutate(Intercept = 1)%>%
mutate(lwage76= ifelse(lwage76==".","0",lwage76) )%>%
mutate(lwage76 = as.numeric(lwage76)) %>%
mutate(iq = ifelse(iq==".","0",iq)) %>%
mutate(iq = as.numeric(iq)) %>%
mutate(exp = age76-ed76-6) %>%
mutate(expsq = exp^2) %>%
mutate(age=age76,agesq=age76^2) %>%
mutate(f1 = ifelse(famed==1,1,0),
f2 = ifelse(famed==2,1,0),
f3 = ifelse(famed==3,1,0),
f4 = ifelse(famed==4,1,0),
f5 = ifelse(famed==5,1,0),
f6 = ifelse(famed==6,1,0),
f7 = ifelse(famed==7,1,0),
f8 = ifelse(famed==8,1,0))
Proximity_Data
library(AER)
# load CollegeDistance data set
data("CollegeDistance")
# read out relevant variables
Y <- CollegeDistance$score
X <- CollegeDistance$education
I <- CollegeDistance$distance
fit <- lm(X ~ I)
summary(fit)
fit <- lm(Y ~ X)
resid <- residuals(fit)
summary(fit)
fit <- lm(X ~ I)
summary(fit)
fit <- lm(Y ~ X)
fit <- lm(X ~ I)
summary(fit)
I
fit <- lm(Y ~ X)
resid <- residuals(fit)
summary(fit)
# correlation between X and residuals
var(resid)
cor.test(X,resid)
